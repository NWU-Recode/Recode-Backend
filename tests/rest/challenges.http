@baseUrl = http://localhost:8000
@json = application/json

# ---- Auth ----
POST {{baseUrl}}/auth/login
Content-Type: {{json}}

{
  "email": "{{LECTURER_EMAIL}}",
  "password": "{{LECTURER_PASSWORD}}"
}

> {% client.global.set("LECTURER_TOKEN", response.body.access_token); %}

###

POST {{baseUrl}}/auth/login
Content-Type: {{json}}

{
  "email": "{{STUDENT_EMAIL}}",
  "password": "{{STUDENT_PASSWORD}}"
}

> {% client.global.set("STUDENT_TOKEN", response.body.access_token); %}

###

# ---- Create weekly challenges from slides (lecturer) ----
POST {{baseUrl}}/challenges/create
Authorization: Bearer {{LECTURER_TOKEN}}
Content-Type: {{json}}

{
  "slides_url": "supabase://slides-bucket/2025S2/w01/variables-loops/1751875200-Week1_Variables_Loops.pptx",
  "force": false
}

###

# Explicit week create
POST {{baseUrl}}/challenges/1/create
Authorization: Bearer {{LECTURER_TOKEN}}
Content-Type: {{json}}

{
  "slides_url": "supabase://slides-bucket/2025S2/w01/variables-loops/1751875200-Week1_Variables_Loops.pptx",
  "force": false
}

###

# ---- Publish (lecturer) ----
POST {{baseUrl}}/challenges/publish/1
Authorization: Bearer {{LECTURER_TOKEN}}

###

# ---- Semester overview (student) ----
GET {{baseUrl}}/challenges/semester/overview
Authorization: Bearer {{STUDENT_TOKEN}}

###

# ---- Attempt & Submit (student) ----
@PLAIN_CHALLENGE_ID = 00000000-0000-0000-0000-000000000000

GET {{baseUrl}}/challenges/{{PLAIN_CHALLENGE_ID}}/attempt
Authorization: Bearer {{STUDENT_TOKEN}}

###

POST {{baseUrl}}/challenges/{{PLAIN_CHALLENGE_ID}}/submit
Authorization: Bearer {{STUDENT_TOKEN}}

###

# Submit with code for missing questions
POST {{baseUrl}}/challenges/{{PLAIN_CHALLENGE_ID}}/submit
Authorization: Bearer {{STUDENT_TOKEN}}
Content-Type: {{json}}

{
  "items": [
    {
      "question_id": "00000000-0000-0000-0000-000000000000",
      "source_code": "print('hello')",
      "stdin": ""
    }
  ]
}

###

# ---- Special (ruby/emerald) single-question challenge ----
@SPECIAL_CHALLENGE_ID = 00000000-0000-0000-0000-000000000000
GET {{baseUrl}}/challenges/{{SPECIAL_CHALLENGE_ID}}/attempt
Authorization: Bearer {{STUDENT_TOKEN}}

###

POST {{baseUrl}}/challenges/{{SPECIAL_CHALLENGE_ID}}/submit
Authorization: Bearer {{STUDENT_TOKEN}}

